{"version":3,"sources":["images/default_profile_picture.jpg","serviceWorker.js","global_components/firebase.js","global_components/AuthProvider.js","global_components/PrivateRoute.js","screens/Login/index.tsx","screens/Chat/components/ContactList/index.js","screens/Chat/components/Modal/index.tsx","screens/Chat/components/Spinner/index.tsx","screens/Chat/components/FriendInfo/index.js","redux/chat/actions.ts","redux/chat/types.ts","screens/Chat/components/Messages/index.tsx","screens/Chat/components/MessageForm/index.tsx","screens/Chat/index.tsx","screens/Register/index.tsx","global_components/PublicRoute.js","redux/chat/reducer.ts","redux/store.ts","index.js"],"names":["module","exports","Boolean","window","location","hostname","match","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","this","auth","db","firestore","storageRef","storage","ref","email","password","signInWithEmailAndPassword","name","createUserWithEmailAndPassword","cred","user","updateProfile","displayName","collection","doc","uid","set","exists","console","log","signOut","message","friendID","currentUserRef","currentUser","friendRef","runTransaction","transaction","a","get","data","friends","chatID","newChat","id","merge","add","from","text","createdAt","FieldValue","serverTimestamp","unsubscribe","dispatchMessages","where","Timestamp","fromDate","Date","onSnapshot","querySnapshot","empty","size","messages","docChanges","forEach","type","push","lastMessageSnapshot","orderBy","startAfter","limit","previous10MessageSnapshots","docs","length","map","reverse","last20MessagesSnapshots","docsLength","undefined","profilePicture","Promise","resolve","reject","profilePictureRef","child","fullPath","bucket","uploadTask","put","on","snapshot","progress","bytesTransferred","totalBytes","state","TaskState","PAUSED","RUNNING","err","getDownloadURL","then","downloadURL","avatarURL","AuthContext","React","createContext","AuthProvider","children","useState","setCurrentUser","pending","setPending","useEffect","onAuthStateChanged","Provider","value","PrivateRoute","rest","useContext","to","Login","history","useHistory","setEmail","setPassword","onSubmit","e","preventDefault","login","replace","catch","className","onChange","target","placeholder","ContactList","friendsInfo","currentFriend","setChosenFriend","index","isCurrent","onClick","key","src","require","alt","width","height","Modal","open","ReactDom","createPortal","document","getElementById","Spinner","styles","borderColor","margin","style","Array","_","FriendInfo","friendName","minWidth","maxWidth","x","y","aspect","unit","crop","setCrop","setCompletedCrop","isModalOpen","setIsModalOpen","imageDataUrl","setImageDataUrl","avatarUrl","setAvatarUrl","isSavingAvatar","setIsSavingAvatar","imageRef","useRef","getMyAvatarURL","downloadedAvatarUrl","fetchAvatarUrl","getCroppedImg","image","fileName","canvas","createElement","scaleX","naturalWidth","scaleY","naturalHeight","getContext","drawImage","toBlob","blob","URL","revokeObjectURL","newAvatarUrl","createObjectURL","saveCroppedImage","current","changeProfilePicture","donwloadURL","htmlFor","accept","files","reader","FileReader","addEventListener","result","readAsDataURL","onClose","stopPropagation","percentCrop","onComplete","onImageLoaded","imageStyle","IMAGE_PREVIEW_STYLES","circularCrop","ruleOfThirds","maxHeight","objectFit","addLast20Messages","payload","addError","error","addNewMessages","add10PreviousMessages","startFetching20LastMessages","stopFetching20LastMessages","startFetching10PreviousMessages","stopFetching10PreviousMessages","Messages","props","currentUserID","intersectionObserverRef","firstMessageRef","messagesContainerRef","setFirstMessageRef","observeFirstMessage","disconnect","IntersectionObserver","entries","isIntersecting","fetch10PreviousMessages","observe","getMyUID","createRef","node","fetchLast20Messages","prevProps","scrollHeight","scrollTop","isFetching10PreviousMessages","isFetching20LastMessages","isFirstMessage","Component","mapDispatchToProps","dispatch","get10PreviousMessages","previous10Messages","getState","getLast20Messages","last20Messages","chat","cancelPreviousListener","listenForNewMessages","connect","MessageForm","useDispatch","setMessage","sendMessage","Chat","setFriendsInfo","currentUserUID","getUsers","usersInfo","filter","getFriendsInfo","useLocation","pathname","path","render","params","Register","setName","passwordConfirmation","setPasswordConfirmation","register","res","PublicRoute","initialState","rootReducer","combineReducers","action","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","useSelector","ReactDOM","StrictMode","exact","navigator","serviceWorker","ready","registration","unregister"],"mappings":"kFAAAA,EAAOC,QAAU,+uE,wUCYGC,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2D,wGCbAC,G,kBAAiB,CACrBC,OAAQ,0CACRC,WAAY,8BACZC,YAAa,qCACbC,UAAW,cACXC,cAAe,0BACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,iBA2QF,M,WAvQb,aAAe,oBACbC,IAASC,cAAcV,GACvBW,KAAKC,KAAOH,IAASG,OACrBD,KAAKE,GAAKJ,IAASK,YACnBH,KAAKI,WAAaN,IAASO,UAAUC,M,kDAGjCC,EAAOC,GACX,OAAOR,KAAKC,KAAKQ,2BAA2BF,EAAOC,K,wEAGtCE,EAAMH,EAAOC,G,kGAELR,KAAKC,KAAKU,+BAC3BJ,EACAC,G,cAFII,E,OAIEC,EAASD,EAATC,K,SAEFA,EAAKC,cAAc,CACvBC,YAAaL,I,uBAGTV,KAAKE,GAAGc,WAAW,SAASC,IAAIJ,EAAKK,KAAKC,IAAI,CAClDC,QAAQ,EACRL,YAAaF,EAAKE,c,gCAGb,W,kCAEPM,QAAQC,IAAI,mBAAZ,M,oJAKF,OAAOtB,KAAKC,KAAKsB,Y,2EAGDC,EAASC,G,uFACnBC,EAAiB1B,KAAKE,GACzBc,WAAW,SACXC,IAAIjB,KAAKC,KAAK0B,YAAYT,KAEvBU,EAAY5B,KAAKE,GAAGc,WAAW,SAASC,IAAIQ,G,kBAG1CzB,KAAKE,GAAG2B,eAAR,uCAAuB,WAAOC,GAAP,qBAAAC,EAAA,sEAEnBD,EAAYE,IAAIN,GAFG,8BAGzBO,OAHyB,gBACnBC,EADmB,EACnBA,SAIJC,EAASD,EAAQT,MAEbW,EAAU,EAAKlC,GAAGc,WAAW,SAASC,MAC5CkB,EAASC,EAAQC,GAEjBX,EAAeP,IACb,CACEe,QAAQ,eACLT,EAAWU,IAGhB,CAAEG,OAAO,IAGXV,EAAUT,IACR,CACEe,QAAQ,eACL,EAAKjC,KAAK0B,YAAYT,IAAMiB,IAGjC,CAAEG,OAAO,KAIb,EAAKpC,GAAGc,WAAW,SAASC,IAAIkB,GAAQnB,WAAW,YAAYuB,IAAI,CACjEC,KAAM,EAAKvC,KAAK0B,YAAYT,IAC5BuB,KAAMjB,EACNkB,UAAW5C,IAASK,UAAUwC,WAAWC,oBAhChB,2CAAvB,kCAAA5C,KAAA,gB,uDAoCNqB,QAAQC,IAAI,uBAAwB,KAAIE,S,mJAK1C,OAAOxB,KAAKE,GAAGc,WAAW,SAASgB,Q,+CAI/BhC,KAAK6C,aAAa7C,KAAK6C,gB,oFAGFC,EAAkBrB,G,yFAEnCzB,KAAKE,GAAGc,WAAW,SAASC,IAAIjB,KAAKC,KAAK0B,YAAYT,KAAKc,M,8BACjEC,O,oBAFMC,E,EAAAA,SAIKT,G,yCAAkB,I,OAE/BzB,KAAK6C,YAAc7C,KAAKE,GACrBc,WAAW,SACXC,IAAIiB,EAAQT,IACZT,WAAW,YACX+B,MACC,YACA,KACAjD,IAASK,UAAU6C,UAAUC,SAAS,IAAIC,OAE3CC,YAAW,SAACC,GACX,GAAIA,EAAcC,MAChB,MAAO,GAEThC,QAAQC,IAAI,SAAU8B,EAAcE,MAEpC,IAAMC,EAAW,GACjBH,EAAcI,aAAaC,SAAQ,SAAUjC,GAC3C,GAAqB,UAAjBA,EAAQkC,KAAkB,CAC5BrC,QAAQC,IAAI,gBAAiBE,EAAQP,IAAIgB,QADb,MAEMT,EAAQP,IAAIgB,OAAtCO,EAFoB,EAEpBA,KAAMC,EAFc,EAEdA,KAAMC,EAFQ,EAERA,UACpBa,EAASI,KAAK,CAAEnB,OAAMC,OAAMC,YAAWL,GAAIb,EAAQP,IAAIoB,SAI3DS,EAAiBS,M,0QAKhBvD,KAAK4D,oB,yCAA4B,I,uBAEG5D,KAAKE,GAC3Cc,WAAW,SACXC,IAAIjB,KAAKmC,QACTnB,WAAW,YACX6C,QAAQ,YAAa,QACrBC,WAAW9D,KAAK4D,qBAChBG,MAAM,IACN/B,M,cAPGgC,E,OASNhE,KAAK4D,oBACHI,EAA2BC,KACzBD,EAA2BC,KAAKC,OAAS,G,kBAGtCF,EAA2BC,KAC/BE,KAAI,SAAClD,GAAD,sBACAA,EAAIgB,OADJ,CAEHI,GAAIpB,EAAIoB,QAET+B,W,uLAGmB3C,G,sGAGZzB,KAAKE,GAAGc,WAAW,SAASC,IAAIjB,KAAKC,KAAK0B,YAAYT,KAAKc,M,8BACjEC,O,oBAFMC,E,EAAAA,SAIKT,G,yCAAkB,I,cAE/BzB,KAAKmC,OAASD,EAAQT,G,UAEgBzB,KAAKE,GACxCc,WAAW,SACXC,IAAIjB,KAAKmC,QACTnB,WAAW,YACX6C,QAAQ,YAAa,QACrBE,MAAM,IACN/B,M,eANGqC,E,OAQAC,EAAaD,EAAwBJ,KAAKC,OAG9ClE,KAAK4D,oBADHU,EAAa,QACYC,EAEAF,EAAwBJ,KAAKK,EAAa,G,kBAGhED,EAAwBJ,KAC5BE,KAAI,SAAClD,GAAD,sBACAA,EAAIgB,OADJ,CAEHI,GAAIpB,EAAIoB,QAET+B,W,yCAEH/C,QAAQC,IAAI,sCAAZ,M,kBACO,KAAIE,S,kJAKb,OAAOxB,KAAKC,KAAK0B,YAAYT,M,2HAcJsD,G,qGAClB,IAAIC,SAAQ,SAACC,EAASC,GAC3B,IAAMC,EAAoB,EAAKxE,WAAWyE,MAAhB,0BACL,EAAK5E,KAAK0B,YAAYT,MAG3CG,QAAQC,IAAI,aAAcsD,EAAkBE,UAC5CzD,QAAQC,IAAI,SAAUsD,EAAkBlE,MACxCW,QAAQC,IAAI,WAAYsD,EAAkBG,QAE1C,IAAMC,EAAaJ,EAAkBK,IAAIT,GAEzCQ,EAAWE,GACT,iBACA,SAAUC,GACR,IAAIC,EACDD,EAASE,iBAAmBF,EAASG,WAAc,IAEtD,OADAjE,QAAQC,IAAI,aAAe8D,EAAW,UAC9BD,EAASI,OACf,KAAKzF,IAASO,QAAQmF,UAAUC,OAC9BpE,QAAQC,IAAI,oBACZ,MACF,KAAKxB,IAASO,QAAQmF,UAAUE,QAC9BrE,QAAQC,IAAI,yBAIlB,SAAUqE,GACRtE,QAAQC,IAAI,wBAAyBqE,GACrChB,EAAOgB,EAAInE,YAEb,WACEwD,EAAWG,SAAS7E,IAAIsF,iBAAiBC,MAAK,SAAUC,GACtDzE,QAAQC,IAAI,oBAAqBwE,GACjCpB,EAAQoB,a,6PAQZ9F,KAAK+F,U,yCAAkB/F,KAAK+F,W,uBAER/F,KAAKI,WAC1ByE,MADqB,0BACI7E,KAAKC,KAAK0B,YAAYT,MAC/C0E,iB,cAFGG,E,OAIN/F,KAAK+F,UAAYA,E,kBAEVA,G,+VC/QEC,EAAcC,IAAMC,cAAc,CAAEvE,YAAa,OA8B/CwE,EA5BM,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAAe,EACCC,mBAAS,MADV,mBAC9B1E,EAD8B,KACjB2E,EADiB,OAEPD,oBAAS,GAFF,mBAE9BE,EAF8B,KAErBC,EAFqB,KAarC,OATAC,qBAAU,WACR3G,EAASG,KAAKyG,oBAAmB,SAAC7F,GAGhCyF,EAAezF,GACf2F,GAAW,QAEZ,IAECD,EACK,kDAIP,kBAACP,EAAYW,SAAb,CACEC,MAAO,CACLjF,gBAGDyE,ICdQS,EAVM,SAAC,GAA2B,IAAzBT,EAAwB,EAAxBA,SAAaU,EAAW,4BAG9C,OAFwBC,qBAAWf,GAA3BrE,YAGN,kBAAC,IAAUmF,EAAOV,GAElB,kBAAC,IAAD,CAAUY,GAAG,YC4DFC,G,MAhED,WACZ,IAAMC,EAAUC,cADE,EAEQd,mBAAS,wBAFjB,mBAEX9F,EAFW,KAEJ6G,EAFI,OAGcf,mBAAS,YAHvB,mBAGX7F,EAHW,KAGD6G,EAHC,KAiBlB,OACE,yBAAKhF,GAAG,mBACN,0BAAMiF,SAdW,SAACC,GACpBA,EAAEC,iBACF1H,EACG2H,MAAMlH,EAAOC,GACbqF,MAAK,YAAc,EAAXhF,KAGPqG,EAAQQ,QAAQ,YAEjBC,OAAM,SAAChC,GAAD,OAAStE,QAAQC,IAAI,QAASqE,OAKPtD,GAAG,cAC/B,kCACE,8CACa,0BAAMuF,UAAU,wBAAhB,eAGb,yBAAKA,UAAU,iBACb,4BAAQA,UAAU,wBAAlB,UACA,4BAAQA,UAAU,wBAAlB,aAGF,2BACElE,KAAK,QACLhD,KAAK,QACL2B,GAAG,oBACHuF,UAAU,cACVhB,MAAOrG,EACPsH,SAAU,SAACN,GAAD,OAAOH,EAASG,EAAEO,OAAOlB,QACnCmB,YAAY,UAGd,2BACErE,KAAK,WACLhD,KAAK,WACL2B,GAAG,uBACHuF,UAAU,cACVhB,MAAOpG,EACPqH,SAAU,SAACN,GAAD,OAAOF,EAAYE,EAAEO,OAAOlB,QACtCmB,YAAY,aAGd,4BAAQ1F,GAAG,uBAAX,WACA,yBAAKA,GAAG,6BACN,6DAEA,kBAAC,IAAD,CAAMA,GAAG,kCAAkC2E,GAAG,aAA9C,uBCrBGgB,G,YAnCK,SAAC,GAAqB,IAAnBC,EAAkB,EAAlBA,YAAkB,EACE5B,mBAAS,GADX,mBAChC6B,EADgC,KACjBC,EADiB,KAOvC,OAJA1B,qBAAU,cAEP,CAACwB,IAGF,yBAAK5F,GAAG,0BACL4F,EAAY9D,KAAI,WAAsBiE,GAAW,IAA9BrH,EAA6B,EAA7BA,YAAasB,EAAgB,EAAhBA,GACzBgG,EAAYH,IAAkBE,EAEpC,OACE,wBACEE,QAAS,kBAAMH,EAAgBC,IAC/BR,UAAS,oBAAeS,GAAa,sBACrCE,IAAKlG,GAEL,kBAAC,IAAD,CAAM2E,GAAE,gBAAW3E,GAAMuF,UAAU,mBACjC,yBACEY,IAAKC,EAAQ,IACbC,IAAI,kBACJd,UAAU,oBACVe,MAAM,KACNC,OAAO,OAER7H,U,yBCJA8H,G,YAXD,SAAC,GAA+B,IAA7BC,EAA4B,EAA5BA,KAAM1C,EAAsB,EAAtBA,SACrB,OAAK0C,EAEEC,IAASC,aACd,oCACE,yBAAK3G,GAAG,WAAW+D,IAErB6C,SAASC,eAAe,WANR,OCgBLC,G,MAtBkB,SAAC,GAAD,QAC/BC,OAAUC,GADqB,aACG,CAChCA,YAAa,aACbC,OAAQ,QAHqB,GACrBD,YAAaC,EADQ,EACRA,OADQ,OAM/B,yBAAK1B,UAAU,WAAW2B,MAAO,CAAED,WAMhCE,MAAMhH,KAAK,CAAE0B,OAAQ,IAAKC,KAAI,SAACsF,EAAGrB,GAAJ,OAC7B,yBACEmB,MAAO,CACLF,YAAY,GAAD,OAAKA,EAAL,iDCwLNK,EAxMI,SAAC,GAAoB,IAAlBC,EAAiB,EAAjBA,WAAiB,GACrBxC,cACQd,mBAAS,CAC/BuD,SAAU,GAEVjB,MAAO,GAEPkB,SAAU,IAEVC,EAAG,GACHC,EAAG,GACHC,OAAQ,EACRC,KAAM,OAZ6B,mBAE9BC,EAF8B,KAExBC,EAFwB,OAcK9D,mBAAS,MAdd,mBAcf+D,GAde,aAeC/D,oBAAS,GAfV,mBAe9BgE,EAf8B,KAejBC,EAfiB,OAgBGjE,mBAAS,IAhBZ,mBAgB9BkE,EAhB8B,KAgBhBC,EAhBgB,OAiBHnE,mBAAS,IAjBN,mBAiB9BoE,EAjB8B,KAiBnBC,EAjBmB,OAkBOrE,mBAAS,IAlBhB,mBAkB9BsE,EAlB8B,KAkBdC,EAlBc,KAmB/BC,EAAWC,mBAWjBrE,qBAAU,WACRpF,QAAQC,IAAI,eAAgBmJ,GAER,uCAAG,4BAAA1I,EAAA,sEACajC,EAASiL,iBADtB,OACfC,EADe,OAErBN,EAAaM,GAFQ,2CAAH,oDAKpBC,KACC,IAEH,IAoBMC,EAAgB,SAACC,EAAOjB,EAAMkB,GAClC,IAAMC,EAASpC,SAASqC,cAAc,UAChCC,EAASJ,EAAMK,aAAeL,EAAMxC,MACpC8C,EAASN,EAAMO,cAAgBP,EAAMvC,OAiB3C,OAhBAyC,EAAO1C,MAAQuB,EAAKvB,MACpB0C,EAAOzC,OAASsB,EAAKtB,OACTyC,EAAOM,WAAW,MAE1BC,UACFT,EACAjB,EAAKJ,EAAIyB,EACTrB,EAAKH,EAAI0B,EACTvB,EAAKvB,MAAQ4C,EACbrB,EAAKtB,OAAS6C,EACd,EACA,EACAvB,EAAKvB,MACLuB,EAAKtB,QAGA,IAAInE,SAAQ,SAACC,EAASC,GAC3B0G,EAAOQ,QAAO,SAACC,GACb,GAAKA,EAAL,CAKAA,EAAKpL,KAAO0K,EACRX,IACFpJ,QAAQC,IAAI,SAAUwK,GACtB7M,OAAO8M,IAAIC,gBAAgBvB,IAE7B,IAAMwB,EAAehN,OAAO8M,IAAIG,gBAAgBJ,GAChDpH,EAAQ,CAAEuH,eAAcH,YACvB,kBAIDK,EAAgB,uCAAG,kCAAApK,EAAA,2DACnB8I,EAASuB,SAAWlC,EAAKvB,OAASuB,EAAKtB,QADpB,iCAGnBgC,GAAkB,GAHC,SAKkBM,EACnCL,EAASuB,QACTlC,EACA,eARiB,uBAKX+B,EALW,EAKXA,aAAcH,EALH,EAKGA,KAMtBpB,EAAauB,GAXM,UAYOnM,EAASuM,qBAAqBP,GAZrC,QAYbQ,EAZa,OAcnBjL,QAAQC,IAAI,YAAagL,GAdN,kDAgBnBjL,QAAQC,IAAI,UAAW,KAAIE,SAhBR,yBAkBnBoJ,GAAkB,GAClBN,GAAe,GAnBI,6EAAH,qDA4BtB,OAJA7D,qBAAU,WACRpF,QAAQC,IAAI,iBAAkBiJ,KAC7B,CAACA,IAGF,yBAAKlI,GAAG,yBACN,yBAAKA,GAAG,6BACN,yBACEmG,IACEiC,GAEIhC,EAAQ,IAEdC,IAAI,SACJrG,GAAG,kBAEL,0BAAMA,GAAG,eAAT,IAAyBsH,GACzB,6BACA,6BACA,2BAAO4C,QAAQ,gBAAf,yBACA,2BACElK,GAAG,eACHqB,KAAK,OACL8I,OAAO,wBACP3E,SArGkB,SAACN,GAGzB,GAFAlG,QAAQC,IAAI,sBAAuBiG,EAAEO,OAAOlB,OAExCW,EAAEO,OAAO2E,OAASlF,EAAEO,OAAO2E,MAAMvI,OAAS,EAAG,CAC/C,IAAMwI,EAAS,IAAIC,WACnBD,EAAOE,iBAAiB,QAAQ,WAC9BpC,EAAgBkC,EAAOG,QACvBxL,QAAQC,IAAI,kBAAmBoL,EAAOG,QACtCvC,GAAe,MAEjBoC,EAAOI,cAAcvF,EAAEO,OAAO2E,MAAM,IACpClF,EAAEO,OAAOlB,MAAQ,OA6Ff,4BAAQ0B,QAAS,kBAAMgC,GAAe,KAAtC,cAEA,kBAAC,EAAD,CACExB,KAAMuB,EACN0C,QAAS,kBAAMzC,GAAe,IAC9BY,cAAeA,GAEf,yBAAK7I,GAAG,QAAQiG,QAAS,SAACf,GAAD,OAAOA,EAAEyF,oBAChC,yBAAK3K,GAAG,yBACN,kBAAC,IAAD,CACEmG,IAAK+B,EACLL,KAAMA,EACNrC,SAAU,SAACqC,EAAM+C,GACf9C,EAAQD,IAEVgD,WAAY,SAAChD,GACXE,EAAiBF,IAEnBiD,cA/HQ,SAAChC,GACrB9J,QAAQC,IAAI,kBAAmB6J,GAC/BN,EAASuB,QAAUjB,GA8HPiC,WAAYC,EACZC,cAAY,EACZC,cAAY,KAIhB,yBAAKlL,GAAG,2BACN,4BACEuF,UAAU,oCACVU,QAAS,kBAAMgC,GAAe,KAFhC,UAOA,4BACE1C,UAAU,kCACVU,QAAS6D,GAERxB,GACC,kBAAC,EAAD,CAASvB,OAAQ,CAAEC,YAAa,QAASC,OAAQ,SALrD,cAmBR+D,EAAuB,CAC3B1E,MAAO,OACP6E,UAAW,QACXC,UAAW,W,gCC3KPC,EAAoB,SAACnK,GAAD,MAA0B,CAClDG,KC3CkC,uBD4ClCiK,QAAS,CACPpK,cAWEqK,EAAW,SAACC,GAAD,MAAsB,CACrCnK,KCnDuB,YDoDvBiK,QAAS,CACPE,WAIEC,EAAiB,SAACvK,GAAD,MAA0B,CAC/CG,KC7D8B,mBD8D9BiK,QAAS,CACPpK,cA8CEwK,EAAwB,SAACxK,GAAD,MAA0B,CACtDG,KChHsC,2BDiHtCiK,QAAS,CACPpK,cAIEyK,EAA8B,iBAAO,CACzCtK,KC/G6C,oCDkHzCuK,EAA6B,iBAAO,CACxCvK,KClH4C,mCDqHxCwK,EAAkC,iBAAO,CAC7CxK,KCrHiD,wCDwH7CyK,EAAiC,iBAAO,CAC5CzK,KCxHgD,uCCc5C0K,E,kDAQJ,WAAYC,GAAe,IAAD,8BACxB,cAAMA,IARAC,mBAOkB,IANlBC,6BAMkB,IALlBC,qBAKkB,IAJlBC,0BAIkB,IAHlBC,wBAGkB,IA4C1BC,oBAAsB,WAChB,EAAKJ,wBAAwBnC,SAC/B,EAAKmC,wBAAwBnC,QAAQwC,aAGvC,EAAKL,wBAAwBnC,QAAU,IAAIyC,sBACzC,SAACC,GACKA,EAAQ,GAAGC,gBACb,EAAKV,MAAMW,6BAKb,EAAKR,iBAAmB,EAAKD,wBAAwBnC,SACvD,EAAKmC,wBAAwBnC,QAAQ6C,QAAQ,EAAKT,kBAxDpD,EAAKjJ,MAAQ,GACb,EAAK+I,cAAgBxO,EAASoP,WAE9B,EAAKX,wBAA0BY,sBAC/B,EAAKX,gBAAkB,KACvB,EAAKC,qBAAuBU,sBAC5B,EAAKT,mBAAqB,SAACU,GAEzB,EAAKZ,gBAAkBY,GAVD,E,gEAexBpP,KAAK2O,sBACL3O,KAAKqO,MAAMgB,oBAAoBrP,KAAKqO,MAAM5M,Y,8CAGpB6N,GACtB,OACEA,EAAU/L,SAASW,OAASlE,KAAKqO,MAAM9K,SAASW,QAChDlE,KAAKyO,qBAAqBrC,QAGxBpM,KAAKyO,qBAAqBrC,QAAQmD,aAClCvP,KAAKyO,qBAAqBrC,QAAQoD,UAG/B,O,yCAGUF,EAAkB7F,EAAQtE,GACvCmK,EAAU7N,WAAazB,KAAKqO,MAAM5M,UACpCzB,KAAKqO,MAAMgB,oBAAoBrP,KAAKqO,MAAM5M,UAExC6N,EAAU/L,WAAavD,KAAKqO,MAAM9K,UAAUvD,KAAK2O,sBAEpC,OAAbxJ,GAAqBnF,KAAKyO,qBAAqBrC,UACjDpM,KAAKyO,qBAAqBrC,QAAQoD,UAChCxP,KAAKyO,qBAAqBrC,QAAQmD,aAAepK,K,+BAqB7C,IAAD,OAIP,OAHInF,KAAKqO,MAAMoB,8BACbpO,QAAQC,IAAI,YAGZ,yBAAKe,GAAG,qBAAqB/B,IAAKN,KAAKyO,sBACrC,yBAAK7G,UAAU,qBACZ5H,KAAKqO,MAAMoB,6BACV,kBAAC,EAAD,MAEA,0BAAM7H,UAAU,oBAAhB,4DAMH5H,KAAKqO,MAAMqB,yBACV,kBAAC,EAAD,MAEA1P,KAAKqO,MAAM9K,SAASY,KAAI,WAAqBiE,GAAW,IAA7B/F,EAA4B,EAA5BA,GAAII,EAAwB,EAAxBA,KAAMD,EAAkB,EAAlBA,KAC7BmN,EAA2B,IAAVvH,EAEvB,OACE,uCACEG,IAAKlG,GACAsN,EAAiB,CAAErP,IAAK,EAAKoO,oBAAuB,GAF3D,CAGE9G,UAAS,0BACP,EAAK0G,gBAAkB9L,EACnB,kCACA,oCAGN,0BAAMoF,UAAU,WAAWnF,Y,GArGpBmN,aAqHjBC,EAAqB,CAAEb,wBF/CU,yDAAgB,WAAOc,GAAP,eAAA/N,EAAA,6DACrD+N,EAAS5B,KAD4C,kBAGlBpO,EAASiQ,wBAHS,YAIxBxL,KADrByL,EAH6C,QAKjDjC,EAAsB,KAEtB+B,EAAS3B,KACT2B,EAAS/B,EAAsBiC,KARkB,gDAWnD3O,QAAQC,IAAI,iCAAkC,KAAIE,SAClDsO,EAASlC,EAAS,KAAIpM,UAZ6B,yDAAhB,uDE+Ce6N,oBFjInB,SAAC5N,GAAD,8CAAgC,WACjEqO,EACAG,GAFiE,eAAAlO,EAAA,6DAIjE+N,EAAS9B,KAJwD,kBAMlClO,EAASoQ,kBAAkBzO,GANO,YAOxC8C,KADjB4L,EANyD,QAQ7DzC,EAAkB,KAElBoC,EAAS7B,KACT6B,EAASpC,EAAkByC,KAXkC,gDAc/D9O,QAAQC,IAAI,iCAAkC,KAAIE,SAClDsO,EAASlC,EAAS,KAAIpM,UAfyC,yBAiB3DyO,IAAWG,KAAK7M,SAASW,OAAS,IACpC7C,QAAQC,IAAI,gBACZxB,EAASuQ,yBACTvQ,EAASwQ,sBACP,SAAC/M,GAAD,OAAyBuM,EAAShC,EAAevK,MACjD9B,IAtB2D,4EAAhC,0DEmIpB8O,eARS,SAAChL,GAAD,MAAuB,CAC7ChC,SAAUgC,EAAM6K,KAAK7M,SACrBmM,yBAA0BnK,EAAM6K,KAAKV,yBACrCD,6BAA8BlK,EAAM6K,KAAKX,gCAKHI,EAAzBU,CAA6CnC,GChH7CoC,G,MA7BK,SAAC,GAAwC,IAAtC/O,EAAqC,EAArCA,SACfqO,EAAWW,cADyC,EAE5BpK,mBAAS,IAFmB,mBAEnD7E,EAFmD,KAE1CkP,EAF0C,KAe1D,OAJAjK,qBAAU,eAKR,0BAAMpE,GAAG,YAAYiF,SAZD,SAACC,GACrBA,EAAEC,iBACc,KAAZhG,IACJsO,EH2DuB,SACzBtO,EACAC,GAFyB,8CAGZ,WAAOqO,EAAUG,GAAjB,eAAAlO,EAAA,sDAGPwD,EAAQ0K,IAEd,IACEnQ,EAAS6Q,YAAYnP,EAASC,GAAUoE,MAAK,WAC3CxE,QAAQC,IAAI,kBAEd,MAAOqE,GACPmK,EAASlC,EAASjI,EAAInE,UALxB,QAOqC,IAA/B+D,EAAM6K,KAAK7M,SAASW,SACtB7C,QAAQC,IAAI,UACZxB,EAASuQ,yBACTvQ,EAASwQ,sBACP,SAAC/M,GAAD,OAAyBuM,EAAShC,EAAevK,MACjD9B,IAjBO,2CAHY,wDG3DdkP,CAAYnP,EAASC,IAC9BiP,EAAW,OAST,2BACEhN,KAAK,OACLrB,GAAG,aACHuE,MAAOpF,EACPqG,SAAU,SAACN,GAAD,OAAOmJ,EAAWnJ,EAAEO,OAAOlB,QACrCmB,YAAY,iCAEd,4BAAQ1F,GAAG,sBAAX,WC+CSuO,EA3DF,WACX,IAAM1J,EAAUC,cADC,GAEAsJ,cAEqBpK,mBAAmB,KAJxC,mBAIV4B,EAJU,KAIG4I,EAJH,KAmCjB,OA7BApK,qBAAU,YACY,uCAAG,kCAAA1E,EAAA,sEAEb+O,EAAiBhR,EAASoP,WAFb,SAGSpP,EAASiR,WAHlB,OAGb3N,EAHa,OAKb4N,EAAY5N,EAAca,KAAKE,KAAI,SAAClD,GAKxC,MAAO,CAAEF,YAHWE,EAAIgB,OAAOlB,YAGTsB,GAFPpB,EAAPoB,OAKJ4F,EAAc+I,EAAUC,QAAO,qBAAG5O,KAAgByO,KAExDD,EAAe5I,GAfI,kDAiBnB5G,QAAQC,IAAI,4BAAZ,MAjBmB,0DAAH,qDAqBpB4P,KACC,IAGc,UADAC,cAAcC,UACHnJ,EAAY/D,QACtCgD,EAAQQ,QAAR,gBAAyBO,EAAY,GAAG5F,KAGxC,yBAAKuF,UAAU,oBAIb,kBAAC,EAAD,CAAaK,YAAaA,IAC1B,yBAAK5F,GAAG,kBACN,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEgP,KAAI,kBACJC,OAAQ,SAACjD,GAAD,OACN,oCACE,kBAAC,EAAD,CAAU5M,SAAU4M,EAAMjP,MAAMmS,OAAO9P,WACvC,kBAAC,EAAD,CAAaA,SAAU4M,EAAMjP,MAAMmS,OAAO9P,iBAMpD,kBAAC,EAAD,CAAYkI,WAAW,YCcd6H,G,MAzEE,WAAO,IAAD,EACGnL,mBAAS,SADZ,mBACd3F,EADc,KACR+Q,EADQ,OAEKpL,mBAAS,wBAFd,mBAEd9F,EAFc,KAEP6G,EAFO,OAGWf,mBAAS,YAHpB,mBAGd7F,EAHc,KAGJ6G,EAHI,OAImChB,mBAAS,YAJ5C,mBAIdqL,EAJc,KAIQC,EAJR,KAMfzK,EAAUC,cAYhB,OACE,yBAAK9E,GAAG,sBACN,0BAAMA,GAAG,gBAAgBiF,SAZR,SAACC,GACpBA,EAAEC,iBACF1H,EACG8R,SAASlR,EAAMH,EAAOC,GACtBqF,MAAK,SAACgM,GACL3K,EAAQvD,KAAK,aAEdgE,OAAM,SAAChC,GAAD,OAAStE,QAAQC,IAAI,iBAAkBqE,QAM5C,kCACE,6CACa,IACX,0BAAMiC,UAAU,2BAAhB,cAEF,2BACElE,KAAK,OACLrB,GAAG,qBACHuF,UAAU,iBACVG,YAAY,WACZnB,MAAOlG,EACPmH,SAAU,SAACN,GAAD,OAAOkK,EAAQlK,EAAEO,OAAOlB,UAEpC,2BACElD,KAAK,QACLrB,GAAG,sBACHuF,UAAU,iBACVG,YAAY,QACZnB,MAAOrG,EACPsH,SAAU,SAACN,GAAD,OAAOH,EAASG,EAAEO,OAAOlB,UAErC,2BACElD,KAAK,WACLrB,GAAG,yBACH0F,YAAY,WACZH,UAAU,iBACVhB,MAAOpG,EACPqH,SAAU,SAACN,GAAD,OAAOF,EAAYE,EAAEO,OAAOlB,UAExC,2BACElD,KAAK,WACLrB,GAAG,sCACH0F,YAAY,wBACZH,UAAU,iBACVhB,MAAO8K,EACP7J,SAAU,SAACN,GAAD,OAAOoK,EAAwBpK,EAAEO,OAAOlB,UAEpD,4BAAQvE,GAAG,0BAAX,WAEA,yBAAKA,GAAG,6BACN,2DAEA,kBAAC,IAAD,CAAMA,GAAG,kCAAkC2E,GAAG,UAA9C,uBC5DG8K,EAVK,SAAC,GAA2B,IAAzB1L,EAAwB,EAAxBA,SAAaU,EAAW,4BAG7C,OAFwBC,qBAAWf,GAA3BrE,YAGN,kBAAC,IAAD,CAAUqF,GAAG,UAEb,kBAAC,IAAUF,EAAOV,I,wBCNhB2L,GAA8B,CAChCxO,SAAS,GACT9B,cAAU8C,EACVmL,0BAA0B,EAC1BD,8BAA8B,EAC9B5B,WAAOtJ,GCHLyN,GAAcC,YAAgB,CAAC7B,KDMtB,WAAuD,IAAtD7K,EAAqD,uDAA7CwM,GAAcG,EAA+B,uCAEjE,OAAOA,EAAOxO,MACV,INf4B,uBMe5B,IACWH,EAAY2O,EAAOvE,QAAnBpK,SACP,OAAO,eACAgC,EADP,CAEIhC,SAAS,YAAKA,KAGtB,INnBwB,mBMoBxB,OAAO,eACAgC,EADP,CAEIhC,SAAS,GAAD,mBAAMgC,EAAMhC,UAAZ,YAAyB2O,EAAOvE,QAAQpK,aAGpD,IN3BgC,2BM2BA,IACrBA,EAAY2O,EAAOvE,QAAnBpK,SACP,OAAuB,IAApBA,EAASW,OAAqBqB,EAC1B,eACAA,EADP,CAEIhC,SAAS,GAAD,mBAAMA,GAAN,YAAmBgC,EAAMhC,aAIzC,INhCqB,gBMiCjB,OAAO,eACAgC,EADP,CACc9D,SAAUyQ,EAAOvE,QAAQlM,WAG3C,INjCuC,kCMkCnC,OAAO,eACA8D,EADP,CAEImK,0BAA0B,IAGlC,INtCsC,iCMuClC,OAAO,eACAnK,EADP,CAEImK,0BAA0B,IAGlC,IN3C2C,sCM4CvC,OAAO,eACAnK,EADP,CAEIkK,8BAA8B,IAGtC,INhD0C,qCMiDtC,OAAO,eACAlK,EADP,CAEIkK,8BAA8B,IAGtC,IN5DiB,YM4DjB,IACW5B,EAASqE,EAAOvE,QAAhBE,MACP,OAAO,eACAtI,EADP,CAEIsI,UAGR,QACI,OAAOtI,MClEb4M,GAAoBlT,OAAemT,sCAAwCC,IAE3EC,GAAQC,YAAYP,GAAaG,GAAiBK,YAAgBC,OAWzDH,IAFkDI,IAElDJ,ICRfK,IAASrB,OACP,kBAAC,IAAMsB,WAAP,KACE,kBAAC,IAAD,CAAUN,MAAOA,IACf,kBAAC,EAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAUO,OAAK,EAACrQ,KAAK,IAAIwE,GAAG,UAC5B,kBAAC,EAAD,CAAaqK,KAAK,UAChB,kBAAC,EAAD,OAEF,kBAAC,EAAD,CAAaA,KAAK,aAChB,kBAAC,EAAD,OAEF,kBAAC,EAAD,CAAcA,KAAK,SACjB,kBAAC,EAAD,YAOZpI,SAASC,eAAe,SlBgGpB,kBAAmB4J,WACrBA,UAAUC,cAAcC,MACrBnN,MAAK,SAAAoN,GACJA,EAAaC,gBAEdvL,OAAM,SAAAkG,GACLxM,QAAQwM,MAAMA,EAAMrM,c","file":"static/js/main.a39aba37.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAAQABAAD/7QCcUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAIAcAmcAFEtrbFNnM2tISGpYcUlCSGZySWxGHAIoAGJGQk1EMDEwMDBhOTkwMTAwMDA2NzAyMDAwMDBlMDMwMDAwMmYwMzAwMDA1ZjAzMDAwMGQ4MDMwMDAwOTUwNDAwMDAwYzA1MDAwMDQyMDUwMDAwODgwNTAwMDA5ZjA2MDAwMP/bAEMABgQFBgUEBgYFBgcHBggKEAoKCQkKFA4PDBAXFBgYFxQWFhodJR8aGyMcFhYgLCAjJicpKikZHy0wLSgwJSgpKP/bAEMBBwcHCggKEwoKEygaFhooKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKP/CABEIAKAAoAMAIgABEQECEQH/xAAaAAEAAwEBAQAAAAAAAAAAAAAAAwQFAgEG/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAAABEQIRAAAB+4FgAAB7MQJ4jkAAAAAAHVuS2c9EoFOht0bKIAAAAANeWOSUABx3wYwsAAAAHprSxSygAKluqmaKAAAATwdG0JQAHnsBlCwAAAAC/dx9iAUBl6WNZ4AAAAABqZeqTiUCnn6OdYAAAAAJDjZgswCgRZG5UTOdc0AAPTzu3dKlwlAAAA8p3Ri87VGymBqU9QCUAAAAAACpnbmRZ//EACQQAAEDAwMFAQEAAAAAAAAAAAECAzAAESAEEjMTITEyQBAi/9oACAEAAAEFAvsHeukuukuiCJwLlLFAAYOMzacfzlqEytceSxdEjXHktQSJGuPLU+sY702LIy1AJEbPJmfEYNjm8bNyadZObyrqkQdq8VGyZmDdvDU+JmOPDU+syRZODouiRKSqm2tubjN6IKYUpKqQzERels0QRkhmgLSkA0tm2DTe0fA83f8AGRdfxODav//EABQRAQAAAAAAAAAAAAAAAAAAAGD/2gAIAQIRAT8BSf/EABQRAQAAAAAAAAAAAAAAAAAAAGD/2gAIAQERAT8BSf/EACMQAAEEAQQBBQAAAAAAAAAAAAEAICEwEQIiMUASEFFhcZH/2gAIAQAABj8C7kLhcKRfgLcVDNt2fd/laHm3S+bdLxaAXjFg6maDb4l/wLQXE9QXhovAabYWTy/OlTTC3TVK2qXbvxRbK2yzJ56PkOfT66ZC/8QAJRABAAEDBAICAgMAAAAAAAAAAREAITAgMUFRYXFAoRCBsdHh/9oACAEAAAE/IfmBUBWhP70h/ut1D3naIlpJII6KNgwflJL0CTa9U2b5Y3z1tkenLb69cV8Zfoa5DlfW1/ayBQF1pt8GuEkhdyOJ8Dhr1kiejNDJJr9wtlQksFtauTctl6w51SRxna5wxpTHwucR5tIvdOYuwb14INMON8r1s0T3P4a5DYeqcgxhQgzQl3LqgAgIMIGAJXK/00zAh0l2CueoBAgymwZKa6x1zoLmP18GI7Lfz+I+drvh9IV//9oADAMAAAERAhEAABD7777rb77777773yy3777775Tzyj777775zzyv77777rTzyz777775/wA8p++++++p888+++++6f8APO/vvupbPPPPDGfrfPPPPPPPGf/EABoRAQACAwEAAAAAAAAAAAAAAAEQIBEwQAD/2gAIAQIRAT8Q2hKcjwktyW5KVxfEGl9//8QAGxEBAAIDAQEAAAAAAAAAAAAAARAgADAxQBH/2gAIAQERAT8Q2rI+Q74WS7Jy6yNVt9wYXSOf/8QAKBABAAECBQIGAwEAAAAAAAAAAREAMSAhMEFxUWEQQIGRwdGhseHw/9oACAEAAAE/EPOdkABNE5I5BW4HgNMe1o1xylsVLBbrvvUbva38QgAjslJjL/S/VBQCIwjtqiwZkT2MZkPf6XVHuWOQd1q/gcap8nIDd1VOMLJ6/HUEtRAG9HLBIkzvjTFSwbagdQkPbQCxBLqIVcKAFhJMcc3y/XVQSJGXPGm5IAas9WMcG9DJJbCdpCaVVW6y6wScyDjCILCJ7xbX5AX84Zf9FNYIBKYCoA2DChaYScmrAl6mwetDFNvpwxgxHzVZ+qnpfffRk5W/Q9ag+wFv7RIQWAjRevWyVdhd79NSn9JwhAFXIDepoeN4P7aDkCwGrG73qm5+qs+/HigASWfwPIgIjMBs68+E6EhP48nA1jJw1//Z\"","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport \"firebase/auth\";\r\nimport \"firebase/storage\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyDus1I-dkUE4CtOZNlpt8ZKXL5pl1FZ0Mw\",\r\n  authDomain: \"saper-ce3aa.firebaseapp.com\",\r\n  databaseURL: \"https://saper-ce3aa.firebaseio.com\",\r\n  projectId: \"saper-ce3aa\",\r\n  storageBucket: \"saper-ce3aa.appspot.com\",\r\n  messagingSenderId: \"320043537840\",\r\n  appId: \"1:320043537840:web:3d6e8c76ea84c5aa7bb275\",\r\n  measurementId: \"G-GZT12414FL\",\r\n};\r\n\r\nclass Firebase {\r\n  constructor() {\r\n    firebase.initializeApp(firebaseConfig);\r\n    this.auth = firebase.auth();\r\n    this.db = firebase.firestore();\r\n    this.storageRef = firebase.storage().ref();\r\n  }\r\n\r\n  login(email, password) {\r\n    return this.auth.signInWithEmailAndPassword(email, password);\r\n  }\r\n\r\n  async register(name, email, password) {\r\n    try {\r\n      const cred = await this.auth.createUserWithEmailAndPassword(\r\n        email,\r\n        password\r\n      );\r\n      const { user } = cred;\r\n\r\n      await user.updateProfile({\r\n        displayName: name,\r\n      });\r\n\r\n      await this.db.collection(\"users\").doc(user.uid).set({\r\n        exists: true,\r\n        displayName: user.displayName,\r\n      });\r\n\r\n      return \"Success\";\r\n    } catch (err) {\r\n      console.log(\"REGISTER ERROR: \", err);\r\n    }\r\n  }\r\n\r\n  logout() {\r\n    return this.auth.signOut();\r\n  }\r\n\r\n  async sendMessage(message, friendID) {\r\n    const currentUserRef = this.db\r\n      .collection(\"users\")\r\n      .doc(this.auth.currentUser.uid);\r\n\r\n    const friendRef = this.db.collection(\"users\").doc(friendID);\r\n\r\n    try {\r\n      await this.db.runTransaction(async (transaction) => {\r\n        const { friends } = await (\r\n          await transaction.get(currentUserRef)\r\n        ).data();\r\n\r\n        let chatID = friends[friendID];\r\n        if (!chatID) {\r\n          const newChat = this.db.collection(\"chats\").doc();\r\n          chatID = newChat.id;\r\n\r\n          currentUserRef.set(\r\n            {\r\n              friends: {\r\n                [friendID]: chatID,\r\n              },\r\n            },\r\n            { merge: true }\r\n          );\r\n\r\n          friendRef.set(\r\n            {\r\n              friends: {\r\n                [this.auth.currentUser.uid]: chatID,\r\n              },\r\n            },\r\n            { merge: true }\r\n          );\r\n        }\r\n\r\n        this.db.collection(\"chats\").doc(chatID).collection(\"messages\").add({\r\n          from: this.auth.currentUser.uid,\r\n          text: message,\r\n          createdAt: firebase.firestore.FieldValue.serverTimestamp(),\r\n        });\r\n      });\r\n    } catch (err) {\r\n      console.log(\"Transaction failure:\", err.message);\r\n    }\r\n  }\r\n\r\n  getUsers() {\r\n    return this.db.collection(\"users\").get();\r\n  }\r\n\r\n  cancelPreviousListener() {\r\n    if (this.unsubscribe) this.unsubscribe();\r\n  }\r\n\r\n  async listenForNewMessages(dispatchMessages, friendID) {\r\n    const { friends } = await (\r\n      await this.db.collection(\"users\").doc(this.auth.currentUser.uid).get()\r\n    ).data();\r\n\r\n    if (!friends[friendID]) return [];\r\n\r\n    this.unsubscribe = this.db\r\n      .collection(\"chats\")\r\n      .doc(friends[friendID])\r\n      .collection(\"messages\")\r\n      .where(\r\n        \"createdAt\",\r\n        \">=\",\r\n        firebase.firestore.Timestamp.fromDate(new Date())\r\n      )\r\n      .onSnapshot((querySnapshot) => {\r\n        if (querySnapshot.empty) {\r\n          return [];\r\n        }\r\n        console.log(\"SIZE: \", querySnapshot.size);\r\n\r\n        const messages = [];\r\n        querySnapshot.docChanges().forEach(function (message) {\r\n          if (message.type === \"added\") {\r\n            console.log(\"NEW MESSAGE: \", message.doc.data());\r\n            const { from, text, createdAt } = message.doc.data();\r\n            messages.push({ from, text, createdAt, id: message.doc.id });\r\n          }\r\n        });\r\n\r\n        dispatchMessages(messages);\r\n      });\r\n  }\r\n\r\n  async get10PreviousMessages() {\r\n    if (!this.lastMessageSnapshot) return [];\r\n\r\n    const previous10MessageSnapshots = await this.db\r\n      .collection(\"chats\")\r\n      .doc(this.chatID)\r\n      .collection(\"messages\")\r\n      .orderBy(\"createdAt\", \"desc\")\r\n      .startAfter(this.lastMessageSnapshot)\r\n      .limit(10)\r\n      .get();\r\n\r\n    this.lastMessageSnapshot =\r\n      previous10MessageSnapshots.docs[\r\n        previous10MessageSnapshots.docs.length - 1\r\n      ];\r\n\r\n    return previous10MessageSnapshots.docs\r\n      .map((doc) => ({\r\n        ...doc.data(),\r\n        id: doc.id,\r\n      }))\r\n      .reverse();\r\n  }\r\n\r\n  async getLast20Messages(friendID) {\r\n    try {\r\n      const { friends } = await (\r\n        await this.db.collection(\"users\").doc(this.auth.currentUser.uid).get()\r\n      ).data();\r\n\r\n      if (!friends[friendID]) return [];\r\n\r\n      this.chatID = friends[friendID];\r\n\r\n      const last20MessagesSnapshots = await this.db\r\n        .collection(\"chats\")\r\n        .doc(this.chatID)\r\n        .collection(\"messages\")\r\n        .orderBy(\"createdAt\", \"desc\")\r\n        .limit(20)\r\n        .get();\r\n\r\n      const docsLength = last20MessagesSnapshots.docs.length;\r\n\r\n      if (docsLength < 20) {\r\n        this.lastMessageSnapshot = undefined;\r\n      } else {\r\n        this.lastMessageSnapshot = last20MessagesSnapshots.docs[docsLength - 1];\r\n      }\r\n\r\n      return last20MessagesSnapshots.docs\r\n        .map((doc) => ({\r\n          ...doc.data(),\r\n          id: doc.id,\r\n        }))\r\n        .reverse();\r\n    } catch (err) {\r\n      console.log(\"getLast20Messages error try/catch: \", err);\r\n      return err.message;\r\n    }\r\n  }\r\n\r\n  getMyUID() {\r\n    return this.auth.currentUser.uid;\r\n  }\r\n\r\n  getUserInfo() {\r\n    // const user = this.auth.currentUser;\r\n    // user.providerData.forEach(function (profile) {\r\n    //   console.log(\"Sign-in provider: \" + profile.providerId);\r\n    //   console.log(\"  Provider-specific UID: \" + profile.uid);\r\n    //   console.log(\"  Name: \" + profile.displayName);\r\n    //   console.log(\"  Email: \" + profile.email);\r\n    //   console.log(\"  Photo URL: \" + profile.photoURL);\r\n    // });\r\n  }\r\n\r\n  async changeProfilePicture(profilePicture) {\r\n    return new Promise((resolve, reject) => {\r\n      const profilePictureRef = this.storageRef.child(\r\n        `profilePictures/${this.auth.currentUser.uid}`\r\n      );\r\n\r\n      console.log(\"fullPath: \", profilePictureRef.fullPath);\r\n      console.log(\"name: \", profilePictureRef.name);\r\n      console.log(\"bucket: \", profilePictureRef.bucket);\r\n\r\n      const uploadTask = profilePictureRef.put(profilePicture);\r\n\r\n      uploadTask.on(\r\n        \"state_changed\",\r\n        function (snapshot) {\r\n          var progress =\r\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n          console.log(\"Upload is \" + progress + \"% done\");\r\n          switch (snapshot.state) {\r\n            case firebase.storage.TaskState.PAUSED:\r\n              console.log(\"Upload is paused\");\r\n              break;\r\n            case firebase.storage.TaskState.RUNNING:\r\n              console.log(\"Upload is running\");\r\n              break;\r\n          }\r\n        },\r\n        function (err) {\r\n          console.log(\"ERROR in uploadTask: \", err);\r\n          reject(err.message);\r\n        },\r\n        function () {\r\n          uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {\r\n            console.log(\"File available at\", downloadURL);\r\n            resolve(downloadURL);\r\n          });\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  async getMyAvatarURL() {\r\n    if (this.avatarURL) return this.avatarURL;\r\n\r\n    const avatarURL = await this.storageRef\r\n      .child(`profilePictures/${this.auth.currentUser.uid}`)\r\n      .getDownloadURL();\r\n\r\n    this.avatarURL = avatarURL;\r\n\r\n    return avatarURL;\r\n  }\r\n\r\n  async getFriendsAvatarURLs() {}\r\n}\r\n\r\nexport default new Firebase();\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\nimport firebase from \"./firebase\";\r\n\r\nexport const AuthContext = React.createContext({ currentUser: null });\r\n\r\nconst AuthProvider = ({ children }) => {\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [pending, setPending] = useState(true);\r\n\r\n  useEffect(() => {\r\n    firebase.auth.onAuthStateChanged((user) => {\r\n      //console.log(\"onAuthStateChanged: \", user.uid);\r\n\r\n      setCurrentUser(user);\r\n      setPending(false);\r\n    });\r\n  }, []);\r\n\r\n  if (pending) {\r\n    return <>Loading...</>;\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        currentUser,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthProvider;\r\n","import React, { useContext } from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport { AuthContext } from \"./AuthProvider\";\r\n\r\nconst PrivateRoute = ({ children, ...rest }) => {\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  return currentUser ? (\r\n    <Route {...rest}>{children}</Route>\r\n  ) : (\r\n    <Redirect to=\"/login\" />\r\n  );\r\n};\r\n\r\nexport default PrivateRoute;\r\n","import React, { useState, useEffect, useContext, FormEvent } from \"react\";\r\nimport { Link, Redirect, useHistory } from \"react-router-dom\";\r\nimport { AuthContext } from \"../../global_components/AuthProvider\";\r\nimport \"./index.scss\";\r\nimport firebase from \"../../global_components/firebase\";\r\n\r\nconst Login = () => {\r\n  const history = useHistory();\r\n  const [email, setEmail] = useState(\"dominik5@onet.com.pl\");\r\n  const [password, setPassword] = useState(\"dupadupa\");\r\n\r\n  const handleSubmit = (e: FormEvent) => {\r\n    e.preventDefault();\r\n    firebase\r\n      .login(email, password)\r\n      .then(({ user }) => {\r\n        if (user) {\r\n        }\r\n        history.replace(\"/chat\");\r\n      })\r\n      .catch((err) => console.log(\"ERR: \", err));\r\n  };\r\n\r\n  return (\r\n    <div id=\"login-container\">\r\n      <form onSubmit={handleSubmit} id=\"login-form\">\r\n        <fieldset>\r\n          <legend>\r\n            Welcome to <span className=\"login-text-highlight\">Messengera</span>\r\n          </legend>\r\n\r\n          <div className=\"container-row\">\r\n            <button className=\"button-auth-provider\">Google</button>\r\n            <button className=\"button-auth-provider\">Facebook</button>\r\n          </div>\r\n\r\n          <input\r\n            type=\"email\"\r\n            name=\"email\"\r\n            id=\"login-input-email\"\r\n            className=\"login-input\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            placeholder=\"Email\"\r\n          />\r\n\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            id=\"login-input-password\"\r\n            className=\"login-input\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            placeholder=\"Password\"\r\n          />\r\n\r\n          <button id=\"login-submit-button\">Sign in</button>\r\n          <div id=\"register-bottom-container\">\r\n            <span> Don't have an account yet?</span>\r\n\r\n            <Link id=\"register-bottom-container__link\" to=\"/register\">\r\n              Sign up here!\r\n            </Link>\r\n          </div>\r\n        </fieldset>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport \"./index.scss\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst ContactList = ({ friendsInfo }) => {\r\n  const [currentFriend, setChosenFriend] = useState(0);\r\n\r\n  useEffect(() => {\r\n    //console.log(\"FRIENDS: \", friendsInfo);\r\n  }, [friendsInfo]);\r\n\r\n  return (\r\n    <div id=\"contact-list-container\">\r\n      {friendsInfo.map(({ displayName, id }, index) => {\r\n        const isCurrent = currentFriend === index;\r\n\r\n        return (\r\n          <li\r\n            onClick={() => setChosenFriend(index)}\r\n            className={`list-item ${isCurrent && \"list-item--current\"}`}\r\n            key={id}\r\n          >\r\n            <Link to={`/chat/${id}`} className=\"list-item__link\">\r\n              <img\r\n                src={require(\"../../../../images/default_profile_picture.jpg\")}\r\n                alt=\"Profile picture\"\r\n                className=\"list-item__avatar\"\r\n                width=\"50\"\r\n                height=\"50\"\r\n              />\r\n              {displayName}\r\n            </Link>\r\n          </li>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContactList;\r\n","import React from \"react\";\r\nimport ReactDom from \"react-dom\";\r\nimport \"./index.scss\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  children: React.ReactNode;\r\n  onClose:\r\n    | ((event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void)\r\n    | undefined;\r\n  getCroppedImg:\r\n    | ((event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void)\r\n    | undefined;\r\n}\r\n\r\nconst Modal = ({ open, children }: Props) => {\r\n  if (!open) return null;\r\n\r\n  return ReactDom.createPortal(\r\n    <>\r\n      <div id=\"overlay\">{children}</div>\r\n    </>,\r\n    document.getElementById(\"portal\") as Element\r\n  );\r\n};\r\n\r\nexport default Modal;\r\n","import React from \"react\";\r\nimport \"./index.scss\";\r\n\r\ninterface Props {\r\n  styles?: {\r\n    borderColor?: string;\r\n    margin?: string;\r\n  };\r\n}\r\n\r\nconst Spinner: React.FC<Props> = ({\r\n  styles: { borderColor, margin } = {\r\n    borderColor: \"dodgerblue\",\r\n    margin: \"auto\",\r\n  },\r\n}) => (\r\n  <div className=\"lds-ring\" style={{ margin }}>\r\n    {/* <div></div>\r\n    <div></div>\r\n    <div></div>\r\n    <div></div> */}\r\n\r\n    {Array.from({ length: 4 }).map((_, index) => (\r\n      <div\r\n        style={{\r\n          borderColor: `${borderColor} transparent transparent transparent`,\r\n        }}\r\n      ></div>\r\n    ))}\r\n  </div>\r\n);\r\n\r\nexport default Spinner;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport \"./index.scss\";\r\nimport { useHistory } from \"react-router\";\r\nimport firebase from \"../../../../global_components/firebase\";\r\nimport ReactCrop from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\nimport Modal from \"../Modal\";\r\nimport Spinner from \"../Spinner\";\r\n\r\nconst FriendInfo = ({ friendName }) => {\r\n  const history = useHistory();\r\n  const [crop, setCrop] = useState({\r\n    minWidth: 80,\r\n    //minHeight: 80,\r\n    width: 80,\r\n    //height: 100,\r\n    maxWidth: 100,\r\n    //maxHeight: 50,\r\n    x: 10,\r\n    y: 10,\r\n    aspect: 1,\r\n    unit: \"%\",\r\n  });\r\n  const [completedCrop, setCompletedCrop] = useState(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [imageDataUrl, setImageDataUrl] = useState(\"\");\r\n  const [avatarUrl, setAvatarUrl] = useState(\"\");\r\n  const [isSavingAvatar, setIsSavingAvatar] = useState(\"\");\r\n  const imageRef = useRef();\r\n\r\n  const logout = () => {\r\n    firebase\r\n      .logout()\r\n      .then((res) => {\r\n        history.replace(\"/login\");\r\n      })\r\n      .catch((err) => console.log(\"ERROR IN SIGNOUT: \", err));\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log(\"Avatar URL: \", avatarUrl);\r\n\r\n    const fetchAvatarUrl = async () => {\r\n      const downloadedAvatarUrl = await firebase.getMyAvatarURL();\r\n      setAvatarUrl(downloadedAvatarUrl);\r\n    };\r\n\r\n    fetchAvatarUrl();\r\n  }, []);\r\n\r\n  const onImageLoaded = (image) => {\r\n    console.log(\"onImageLoaded: \", image);\r\n    imageRef.current = image;\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    console.log(\"handleImageChange: \", e.target.value);\r\n\r\n    if (e.target.files && e.target.files.length > 0) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => {\r\n        setImageDataUrl(reader.result);\r\n        console.log(\"reader result: \", reader.result);\r\n        setIsModalOpen(true);\r\n      });\r\n      reader.readAsDataURL(e.target.files[0]);\r\n      e.target.value = \"\";\r\n    }\r\n  };\r\n\r\n  const getCroppedImg = (image, crop, fileName) => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const scaleX = image.naturalWidth / image.width;\r\n    const scaleY = image.naturalHeight / image.height;\r\n    canvas.width = crop.width;\r\n    canvas.height = crop.height;\r\n    const ctx = canvas.getContext(\"2d\");\r\n\r\n    ctx.drawImage(\r\n      image,\r\n      crop.x * scaleX,\r\n      crop.y * scaleY,\r\n      crop.width * scaleX,\r\n      crop.height * scaleY,\r\n      0,\r\n      0,\r\n      crop.width,\r\n      crop.height\r\n    );\r\n\r\n    return new Promise((resolve, reject) => {\r\n      canvas.toBlob((blob) => {\r\n        if (!blob) {\r\n          //reject(new Error('Canvas is empty'));\r\n          return;\r\n        }\r\n\r\n        blob.name = fileName;\r\n        if (avatarUrl) {\r\n          console.log(\"BLOB: \", blob);\r\n          window.URL.revokeObjectURL(avatarUrl);\r\n        }\r\n        const newAvatarUrl = window.URL.createObjectURL(blob);\r\n        resolve({ newAvatarUrl, blob });\r\n      }, \"image/jpeg\");\r\n    });\r\n  };\r\n\r\n  const saveCroppedImage = async () => {\r\n    if (imageRef.current && crop.width && crop.height) {\r\n      try {\r\n        setIsSavingAvatar(true);\r\n\r\n        const { newAvatarUrl, blob } = await getCroppedImg(\r\n          imageRef.current,\r\n          crop,\r\n          \"avatar.jpeg\"\r\n        );\r\n\r\n        setAvatarUrl(newAvatarUrl);\r\n        const donwloadURL = await firebase.changeProfilePicture(blob);\r\n\r\n        console.log(\"Success: \", donwloadURL);\r\n      } catch (err) {\r\n        console.log(\"Error: \", err.message);\r\n      } finally {\r\n        setIsSavingAvatar(false);\r\n        setIsModalOpen(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log(\"imageDataUrl; \", imageDataUrl);\r\n  }, [imageDataUrl]);\r\n\r\n  return (\r\n    <div id=\"friend-info-container\">\r\n      <div id=\"avatar-and-name-container\">\r\n        <img\r\n          src={\r\n            avatarUrl\r\n              ? avatarUrl\r\n              : require(\"../../../../images/default_profile_picture.jpg\")\r\n          }\r\n          alt=\"Avatar\"\r\n          id=\"friend-avatar\"\r\n        />\r\n        <span id=\"friend-name\"> {friendName}</span>\r\n        <br />\r\n        <br />\r\n        <label htmlFor=\"input-avatar\">Choose file to upload</label>\r\n        <input\r\n          id=\"input-avatar\"\r\n          type=\"file\"\r\n          accept=\"image/png, image/jpeg\"\r\n          onChange={handleImageChange}\r\n        />\r\n\r\n        <button onClick={() => setIsModalOpen(true)}>Open Modal</button>\r\n\r\n        <Modal\r\n          open={isModalOpen}\r\n          onClose={() => setIsModalOpen(false)}\r\n          getCroppedImg={getCroppedImg}\r\n        >\r\n          <div id=\"modal\" onClick={(e) => e.stopPropagation()}>\r\n            <div id=\"modal-image-container\">\r\n              <ReactCrop\r\n                src={imageDataUrl}\r\n                crop={crop}\r\n                onChange={(crop, percentCrop) => {\r\n                  setCrop(crop);\r\n                }}\r\n                onComplete={(crop) => {\r\n                  setCompletedCrop(crop);\r\n                }}\r\n                onImageLoaded={onImageLoaded}\r\n                imageStyle={IMAGE_PREVIEW_STYLES}\r\n                circularCrop\r\n                ruleOfThirds\r\n              />\r\n            </div>\r\n\r\n            <div id=\"modal-buttons-container\">\r\n              <button\r\n                className=\"modal-button modal-button--cancel\"\r\n                onClick={() => setIsModalOpen(false)}\r\n              >\r\n                Cancel\r\n              </button>\r\n\r\n              <button\r\n                className=\"modal-button modal-button--save\"\r\n                onClick={saveCroppedImage}\r\n              >\r\n                {isSavingAvatar && (\r\n                  <Spinner styles={{ borderColor: \"white\", margin: \"0px\" }} />\r\n                )}\r\n                Save\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FriendInfo;\r\n\r\nconst IMAGE_PREVIEW_STYLES = {\r\n  width: \"auto\",\r\n  maxHeight: \"450px\",\r\n  objectFit: \"contain\",\r\n};\r\n","import {\r\n  ADD_LAST_20_MESSAGES,\r\n  ADD_ERROR,\r\n  ADD_NEW_MESSAGES,\r\n  SET_FRIEND_ID,\r\n  ADD_10_PREVIOUS_MESSAGES,\r\n  START_FETCHING_20_LAST_MESSAGES,\r\n  STOP_FETCHING_20_LAST_MESSAGES,\r\n  STOP_FETCHING_10_PREVIOUS_MESSAGES,\r\n  START_FETCHING_10_PREVIOUS_MESSAGES,\r\n} from \"./types\";\r\nimport { Message } from \"./interfaces\";\r\nimport firebase from \"../../global_components/firebase\";\r\nimport { AppThunk } from \"../store\";\r\n\r\nexport const fetchLast20Messages = (friendID: string): AppThunk => async (\r\n  dispatch,\r\n  getState\r\n) => {\r\n  dispatch(startFetching20LastMessages());\r\n  try {\r\n    const last20Messages = await firebase.getLast20Messages(friendID);\r\n    if (last20Messages === undefined) {\r\n      addLast20Messages([]);\r\n    } else {\r\n      dispatch(stopFetching20LastMessages());\r\n      dispatch(addLast20Messages(last20Messages));\r\n    }\r\n  } catch (err) {\r\n    console.log(\"error in fetchLast20Messages: \", err.message);\r\n    dispatch(addError(err.message));\r\n  } finally {\r\n    if (getState().chat.messages.length > 0) {\r\n      console.log(\"HERE finally\");\r\n      firebase.cancelPreviousListener();\r\n      firebase.listenForNewMessages(\r\n        (messages: Message[]) => dispatch(addNewMessages(messages)),\r\n        friendID\r\n      );\r\n    }\r\n  }\r\n};\r\n\r\nconst addLast20Messages = (messages: Message[]) => ({\r\n  type: ADD_LAST_20_MESSAGES,\r\n  payload: {\r\n    messages,\r\n  },\r\n});\r\n\r\nexport const setFriendID = (friendID: string) => ({\r\n  type: SET_FRIEND_ID,\r\n  payload: {\r\n    friendID,\r\n  },\r\n});\r\n\r\nconst addError = (error: string[]) => ({\r\n  type: ADD_ERROR,\r\n  payload: {\r\n    error,\r\n  },\r\n});\r\n\r\nconst addNewMessages = (messages: Message[]) => ({\r\n  type: ADD_NEW_MESSAGES,\r\n  payload: {\r\n    messages,\r\n  },\r\n});\r\n\r\nexport const sendMessage = (\r\n  message: string,\r\n  friendID: string\r\n): AppThunk => async (dispatch, getState) => {\r\n  //dispatch(addNewMessages([{from: firebase.getMyUID(),  }]))\r\n\r\n  const state = getState();\r\n\r\n  try {\r\n    firebase.sendMessage(message, friendID).then(() => {\r\n      console.log(\"sendMessage\");\r\n    });\r\n  } catch (err) {\r\n    dispatch(addError(err.message));\r\n  } finally {\r\n    if (state.chat.messages.length === 0) {\r\n      console.log(\"HERE 0\");\r\n      firebase.cancelPreviousListener();\r\n      firebase.listenForNewMessages(\r\n        (messages: Message[]) => dispatch(addNewMessages(messages)),\r\n        friendID\r\n      );\r\n    }\r\n  }\r\n};\r\n\r\nexport const fetch10PreviousMessages = (): AppThunk => async (dispatch) => {\r\n  dispatch(startFetching10PreviousMessages());\r\n  try {\r\n    const previous10Messages = await firebase.get10PreviousMessages();\r\n    if (previous10Messages === undefined) {\r\n      add10PreviousMessages([]);\r\n    } else {\r\n      dispatch(stopFetching10PreviousMessages());\r\n      dispatch(add10PreviousMessages(previous10Messages));\r\n    }\r\n  } catch (err) {\r\n    console.log(\"error in fetchLast10Messages: \", err.message);\r\n    dispatch(addError(err.message));\r\n  }\r\n};\r\n\r\nconst add10PreviousMessages = (messages: Message[]) => ({\r\n  type: ADD_10_PREVIOUS_MESSAGES,\r\n  payload: {\r\n    messages,\r\n  },\r\n});\r\n\r\nconst startFetching20LastMessages = () => ({\r\n  type: START_FETCHING_20_LAST_MESSAGES,\r\n});\r\n\r\nconst stopFetching20LastMessages = () => ({\r\n  type: STOP_FETCHING_20_LAST_MESSAGES,\r\n});\r\n\r\nconst startFetching10PreviousMessages = () => ({\r\n  type: START_FETCHING_10_PREVIOUS_MESSAGES,\r\n});\r\n\r\nconst stopFetching10PreviousMessages = () => ({\r\n  type: STOP_FETCHING_10_PREVIOUS_MESSAGES,\r\n});\r\n","export const FETCH_LAST_20_MESSAGES = \"FETCH_LAST_20_MESSAGES\";\r\nexport const ADD_LAST_20_MESSAGES = \"ADD_LAST_20_MESSAGES\";\r\nexport const ADD_10_PREVIOUS_MESSAGES = \"ADD_10_PREVIOUS_MESSAGES\";\r\nexport const SEND_MESSAGE = \"SEND_MESSAGE\";\r\nexport const ADD_NEW_MESSAGES = \"ADD_NEW_MESSAGES\";\r\n\r\nexport const SET_FRIEND_ID = 'SET_FRIEND_ID';\r\nexport const ADD_ERROR = \"ADD_ERROR\";\r\n\r\n\r\nexport const START_FETCHING_20_LAST_MESSAGES = \"START_FETCHING_20_LAST_MESSAGES\";\r\nexport const STOP_FETCHING_20_LAST_MESSAGES = 'STOP_FETCHING_20_LAST_MESSAGES';\r\nexport const START_FETCHING_10_PREVIOUS_MESSAGES = 'START_FETCHING_10_PREVIOUS_MESSAGES';\r\nexport const STOP_FETCHING_10_PREVIOUS_MESSAGES = \"STOP_FETCHING_10_PREVIOUS_MESSAGES\";","import React, {\r\n  Component,\r\n  createRef,\r\n  RefObject,\r\n  MutableRefObject,\r\n} from \"react\";\r\nimport \"./index.scss\";\r\nimport { RootState } from \"../../../../redux/store\";\r\nimport firebase from \"../../../../global_components/firebase\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  fetchLast20Messages,\r\n  fetch10PreviousMessages,\r\n} from \"../../../../redux/chat/actions\";\r\nimport { Message } from \"../../../../redux/chat/interfaces\";\r\nimport { RouteProps } from \"react-router\";\r\nimport Spinner from \"../Spinner\";\r\n\r\ninterface Props {\r\n  fetchLast20Messages: Function;\r\n  fetch10PreviousMessages: Function;\r\n  messages: Message[];\r\n  isFetching20LastMessages: boolean;\r\n  isFetching10PreviousMessages: boolean;\r\n  friendID: string;\r\n}\r\n\r\nclass Messages extends Component<Props & RouteProps> {\r\n  private currentUserID: string;\r\n  private intersectionObserverRef: MutableRefObject<IntersectionObserver | null>;\r\n  private firstMessageRef: HTMLElement | null;\r\n  private messagesContainerRef: RefObject<HTMLDivElement>;\r\n  private setFirstMessageRef: (node: any) => void;\r\n  //private observeFirstMessage: () => void;\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {};\r\n    this.currentUserID = firebase.getMyUID();\r\n\r\n    this.intersectionObserverRef = createRef();\r\n    this.firstMessageRef = null;\r\n    this.messagesContainerRef = createRef();\r\n    this.setFirstMessageRef = (node) => {\r\n      //callback ref\r\n      this.firstMessageRef = node;\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.observeFirstMessage();\r\n    this.props.fetchLast20Messages(this.props.friendID);\r\n  }\r\n\r\n  getSnapshotBeforeUpdate(prevProps: Props) {\r\n    if (\r\n      prevProps.messages.length < this.props.messages.length &&\r\n      this.messagesContainerRef.current\r\n    ) {\r\n      return (\r\n        this.messagesContainerRef.current.scrollHeight -\r\n        this.messagesContainerRef.current.scrollTop\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n\r\n  componentDidUpdate(prevProps: Props, _: any, snapshot: number) {\r\n    if (prevProps.friendID !== this.props.friendID)\r\n      this.props.fetchLast20Messages(this.props.friendID);\r\n\r\n    if (prevProps.messages !== this.props.messages) this.observeFirstMessage();\r\n\r\n    if (snapshot !== null && this.messagesContainerRef.current) {\r\n      this.messagesContainerRef.current.scrollTop =\r\n        this.messagesContainerRef.current.scrollHeight - snapshot;\r\n    }\r\n  }\r\n\r\n  observeFirstMessage = () => {\r\n    if (this.intersectionObserverRef.current) {\r\n      this.intersectionObserverRef.current.disconnect();\r\n    }\r\n\r\n    this.intersectionObserverRef.current = new IntersectionObserver(\r\n      (entries) => {\r\n        if (entries[0].isIntersecting) {\r\n          this.props.fetch10PreviousMessages();\r\n        }\r\n      }\r\n    );\r\n\r\n    if (this.firstMessageRef && this.intersectionObserverRef.current)\r\n      this.intersectionObserverRef.current.observe(this.firstMessageRef);\r\n  };\r\n\r\n  render() {\r\n    if (this.props.isFetching10PreviousMessages) {\r\n      console.log(\"FETCHING\");\r\n    }\r\n    return (\r\n      <div id=\"messages-container\" ref={this.messagesContainerRef}>\r\n        <div className=\"spinner-container\">\r\n          {this.props.isFetching10PreviousMessages ? (\r\n            <Spinner />\r\n          ) : (\r\n            <span className=\"no-more-messages\">\r\n              To już wszystkie wiadomości w tej konwersacji\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {this.props.isFetching20LastMessages ? (\r\n          <Spinner />\r\n        ) : (\r\n          this.props.messages.map(({ id, text, from }, index) => {\r\n            const isFirstMessage = index === 0;\r\n\r\n            return (\r\n              <div\r\n                key={id}\r\n                {...(isFirstMessage ? { ref: this.setFirstMessageRef } : {})}\r\n                className={`message-wrapper ${\r\n                  this.currentUserID === from\r\n                    ? \"message-wrapper--position-right\"\r\n                    : \"message-wrapper--position-left\"\r\n                }`}\r\n              >\r\n                <span className=\"message\">{text}</span>\r\n              </div>\r\n            );\r\n          })\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  messages: state.chat.messages,\r\n  isFetching20LastMessages: state.chat.isFetching20LastMessages,\r\n  isFetching10PreviousMessages: state.chat.isFetching10PreviousMessages,\r\n});\r\n\r\nconst mapDispatchToProps = { fetch10PreviousMessages, fetchLast20Messages };\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Messages);\r\n","import React, { useState, useEffect, FormEvent } from \"react\";\r\nimport \"./index.scss\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { sendMessage } from \"../../../../redux/chat/actions\";\r\n\r\nconst MessageForm = ({ friendID }: { friendID: string }) => {\r\n  const dispatch = useDispatch();\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  const submitMessage = (e: FormEvent) => {\r\n    e.preventDefault();\r\n    if (message === \"\") return;\r\n    dispatch(sendMessage(message, friendID));\r\n    setMessage(\"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    //console.log(\"PARAMS: \", friendID);\r\n  });\r\n\r\n  return (\r\n    <form id=\"form-chat\" onSubmit={submitMessage}>\r\n      <input\r\n        type=\"text\"\r\n        id=\"input-chat\"\r\n        value={message}\r\n        onChange={(e) => setMessage(e.target.value)}\r\n        placeholder=\"Wpisz wiadomość...\"\r\n      />\r\n      <button id=\"submit-button-chat\">Send</button>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default MessageForm;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport \"./index.scss\";\r\nimport ContactList from \"./components/ContactList\";\r\nimport FriendInfo from \"./components/FriendInfo\";\r\nimport firebase from \"../../global_components/firebase\";\r\nimport { useHistory, useLocation, useParams } from \"react-router-dom\";\r\nimport Messages from \"./components/Messages\";\r\nimport MessageForm from \"./components/MessageForm\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { fetch10PreviousMessages } from \"../../redux/chat/actions\";\r\nimport { Switch, Route } from \"react-router-dom\";\r\n\r\ninterface Friend {\r\n  id: string;\r\n  displayName: string;\r\n}\r\n\r\nconst Chat = () => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n  const [friendsInfo, setFriendsInfo] = useState<Friend[]>([]);\r\n\r\n  useEffect(() => {\r\n    const getFriendsInfo = async () => {\r\n      try {\r\n        const currentUserUID = firebase.getMyUID();\r\n        const querySnapshot = await firebase.getUsers();\r\n\r\n        const usersInfo = querySnapshot.docs.map((doc) => {\r\n          // doc.data() is never undefined for query doc snapshots\r\n          const displayName = doc.data().displayName;\r\n          const { id } = doc;\r\n\r\n          return { displayName, id };\r\n        });\r\n\r\n        const friendsInfo = usersInfo.filter(({ id }) => id !== currentUserUID);\r\n\r\n        setFriendsInfo(friendsInfo);\r\n      } catch (err) {\r\n        console.log(\"ERROR IN getFriendsInfo: \", err);\r\n      }\r\n    };\r\n\r\n    getFriendsInfo();\r\n  }, []);\r\n\r\n  const pathName = useLocation().pathname;\r\n  if (pathName === \"/chat\" && friendsInfo.length)\r\n    history.replace(`/chat/${friendsInfo[0].id}`);\r\n\r\n  return (\r\n    <div className=\"container-screen\">\r\n      {/* <button onClick={getData}>Get users</button>\r\n \r\n      <button onClick={getUserInfo}>Get user info</button> */}\r\n      <ContactList friendsInfo={friendsInfo} />\r\n      <div id=\"container-chat\">\r\n        <Switch>\r\n          <Route\r\n            path={`/chat/:friendID`}\r\n            render={(props) => (\r\n              <>\r\n                <Messages friendID={props.match.params.friendID} />\r\n                <MessageForm friendID={props.match.params.friendID} />\r\n              </>\r\n            )}\r\n          />\r\n        </Switch>\r\n      </div>\r\n      <FriendInfo friendName=\"Donek\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","import React, {\r\n  useState,\r\n  useEffect,\r\n  ChangeEvent,\r\n  FormEvent,\r\n  useContext,\r\n} from \"react\";\r\nimport { Link, useHistory, Redirect } from \"react-router-dom\";\r\nimport \"./index.scss\";\r\nimport firebase from \"../../global_components/firebase\";\r\nimport { AuthContext } from \"../../global_components/AuthProvider\";\r\n\r\nconst Register = () => {\r\n  const [name, setName] = useState(\"donek\");\r\n  const [email, setEmail] = useState(\"dominik1@onet.com.pl\");\r\n  const [password, setPassword] = useState(\"dupadupa\");\r\n  const [passwordConfirmation, setPasswordConfirmation] = useState(\"dupadupa\");\r\n\r\n  const history = useHistory();\r\n\r\n  const handleSubmit = (e: FormEvent) => {\r\n    e.preventDefault();\r\n    firebase\r\n      .register(name, email, password)\r\n      .then((res) => {\r\n        history.push(\"/login\");\r\n      })\r\n      .catch((err) => console.log(\"REGISTER ERR: \", err));\r\n  };\r\n\r\n  return (\r\n    <div id=\"register-container\">\r\n      <form id=\"register-form\" onSubmit={handleSubmit}>\r\n        <fieldset>\r\n          <legend>\r\n            Welcome to{\" \"}\r\n            <span className=\"register-text-highlight\">Messenger</span>\r\n          </legend>\r\n          <input\r\n            type=\"text\"\r\n            id=\"register-form-name\"\r\n            className=\"register-input\"\r\n            placeholder=\"Username\"\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"email\"\r\n            id=\"register-form-email\"\r\n            className=\"register-input\"\r\n            placeholder=\"Email\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            id=\"register-form-password\"\r\n            placeholder=\"Password\"\r\n            className=\"register-input\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            id=\"register-form-password-confirmation\"\r\n            placeholder=\"Password confirmation\"\r\n            className=\"register-input\"\r\n            value={passwordConfirmation}\r\n            onChange={(e) => setPasswordConfirmation(e.target.value)}\r\n          />\r\n          <button id=\"register-submit-button\">Sign up</button>\r\n\r\n          <div id=\"register-bottom-container\">\r\n            <span> Already have an account?</span>\r\n\r\n            <Link id=\"register-bottom-container__link\" to=\"/login\">\r\n              Sign in here!\r\n            </Link>\r\n          </div>\r\n        </fieldset>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n","import React, { useContext } from \"react\";\r\nimport firebase from \"./firebase\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport { AuthContext } from \"./AuthProvider\";\r\n\r\nconst PublicRoute = ({ children, ...rest }) => {\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  return currentUser ? (\r\n    <Redirect to=\"/chat\" />\r\n  ) : (\r\n    <Route {...rest}>{children}</Route>\r\n  );\r\n};\r\n\r\nexport default PublicRoute;\r\n","import {  MessagesState, MessagesActionTypes} from \"./interfaces\"\r\nimport { ADD_LAST_20_MESSAGES, START_FETCHING_20_LAST_MESSAGES, STOP_FETCHING_20_LAST_MESSAGES, ADD_ERROR, ADD_NEW_MESSAGES, SET_FRIEND_ID, ADD_10_PREVIOUS_MESSAGES, START_FETCHING_10_PREVIOUS_MESSAGES, STOP_FETCHING_10_PREVIOUS_MESSAGES} from \"./types\";\r\n\r\n\r\n\r\nconst initialState: MessagesState = {\r\n    messages:[],\r\n    friendID: undefined,\r\n    isFetching20LastMessages: false,\r\n    isFetching10PreviousMessages: false,\r\n    error: undefined\r\n}\r\n\r\nexport default (state = initialState, action:MessagesActionTypes) => {\r\n\r\n    switch(action.type){\r\n        case ADD_LAST_20_MESSAGES:\r\n            const {messages} = action.payload;\r\n            return {\r\n                ...state,\r\n                messages: [...messages]\r\n            }\r\n            \r\n        case ADD_NEW_MESSAGES: \r\n        return {\r\n            ...state,\r\n            messages: [...state.messages, ...action.payload.messages]\r\n        }\r\n\r\n        case ADD_10_PREVIOUS_MESSAGES: {\r\n            const {messages} = action.payload;\r\n            if(messages.length === 0) return state;// Don't update state if there is no more messages\r\n            return {\r\n                ...state,\r\n                messages: [...messages, ...state.messages]\r\n            }\r\n        }\r\n   \r\n        case SET_FRIEND_ID: \r\n            return {\r\n                ...state, friendID: action.payload.friendID\r\n            }\r\n\r\n        case START_FETCHING_20_LAST_MESSAGES: \r\n            return {\r\n                ...state,\r\n                isFetching20LastMessages: true\r\n            }\r\n\r\n        case STOP_FETCHING_20_LAST_MESSAGES:\r\n            return {\r\n                ...state,\r\n                isFetching20LastMessages: false \r\n            }\r\n\r\n        case START_FETCHING_10_PREVIOUS_MESSAGES: \r\n            return {\r\n                ...state,\r\n                isFetching10PreviousMessages: true\r\n            }\r\n        \r\n        case STOP_FETCHING_10_PREVIOUS_MESSAGES: \r\n            return {\r\n                ...state,\r\n                isFetching10PreviousMessages: false\r\n            }\r\n\r\n        case ADD_ERROR:\r\n            const {error} = action.payload;\r\n            return {\r\n                ...state,\r\n                error   \r\n            } \r\n        \r\n        default:\r\n            return state\r\n    }\r\n}","import {createStore, combineReducers, applyMiddleware, compose} from \"redux\";\r\nimport thunk from 'redux-thunk';\r\nimport { Action } from 'redux'\r\nimport { ThunkAction } from 'redux-thunk'\r\nimport chat from \"./chat/reducer\";\r\nimport { useSelector, TypedUseSelectorHook } from 'react-redux'\r\n\r\nconst rootReducer = combineReducers({chat});\r\n\r\nconst composeEnhancers = (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)));\r\n\r\nexport type RootState = ReturnType<typeof rootReducer>\r\nexport type AppThunk<ReturnType = void> = ThunkAction<\r\n  ReturnType,\r\n  RootState,\r\n  unknown,\r\n  Action<string>\r\n>\r\nexport const useTypedSelector: TypedUseSelectorHook<RootState> = useSelector\r\n\r\nexport default store;","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport { BrowserRouter as Router, Redirect, Switch } from \"react-router-dom\";\r\nimport PrivateRoute from \"./global_components/PrivateRoute\";\r\nimport Login from \"./screens/Login/index.tsx\";\r\nimport Chat from \"./screens/Chat/index.tsx\";\r\nimport Register from \"./screens/Register/index.tsx\";\r\nimport AuthProvider from \"./global_components/AuthProvider\";\r\nimport PublicRoute from \"./global_components/PublicRoute\";\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"./redux/store\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <AuthProvider>\r\n        <Router>\r\n          <Switch>\r\n            <Redirect exact from=\"/\" to=\"/chat\" />\r\n            <PublicRoute path=\"/login\">\r\n              <Login />\r\n            </PublicRoute>\r\n            <PublicRoute path=\"/register\">\r\n              <Register />\r\n            </PublicRoute>\r\n            <PrivateRoute path=\"/chat\">\r\n              <Chat />\r\n            </PrivateRoute>\r\n          </Switch>\r\n        </Router>\r\n      </AuthProvider>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}